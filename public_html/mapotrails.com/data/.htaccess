RewriteEngine On
RewriteBase /
Options -Indexes
Options +FollowSymlinks

#ErrorDocument 500 /error.php?error=500
#ErrorDocument 404 /error.php?error=404
#ErrorDocument 403 /error.php?error=403
#ErrorDocument 401 /error.php?error=401
#RewriteRule ^error/([^/]*)$ /error.php?error_code=$1 [L,QSA]

RewriteRule ^gen/photos/view/([^/]*)$ /photo.php?file=$1 [L,QSA]
RewriteRule ^gen/photos/view/([^/]*)/([^/]*)$ /photo.php?size=$1&file=$2 [L,QSA]

# Enable Compression
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE image/svg+xml
    AddOutputFilterByType DEFLATE image/png
    AddOutputFilterByType DEFLATE image/jpg
    AddOutputFilterByType DEFLATE image/jpeg
    AddOutputFilterByType DEFLATE image/gif
</IfModule>
<IfModule mod_gzip.c>
    mod_gzip_on Yes
    mod_gzip_dechunk Yes
    mod_gzip_item_include file .(html?|txt|css|js|php|pl)$
    mod_gzip_item_include handler ^cgi-script$
    mod_gzip_item_exclude mime ^image/.*
    mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.*
</IfModule>

# Leverage Browser Caching
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access 1 year"
    ExpiresByType image/jpeg "access 1 year"
    ExpiresByType image/gif "access 1 year"
    ExpiresByType image/png "access 1 year"
    ExpiresDefault "access 1 month"
</IfModule>

<IfModule mod_headers.c>
    <FilesMatch "\.(?i:geojson|kml|gpx|json|kmz|gif|jpe?g|png|ttf|woff|woff2)$">
        Header set Access-Control-Allow-Origin *
    </FilesMatch>
    <FilesMatch "\.(?i:gif|jpe?g|png)$">
        Header set Cache-Control "max-age=31536000, public, must-revalidate"
    </FilesMatch>
</IfModule>

# php -- BEGIN cPanel-generated handler, do not edit
# Set the “ea-php84” package as the default “PHP” programming language.
<IfModule mime_module>
  AddHandler application/x-httpd-ea-php84___lsphp .php .php8 .phtml
</IfModule>
# php -- END cPanel-generated handler, do not edit
