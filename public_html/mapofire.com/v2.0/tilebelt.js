"use strict";var d2r=Math.PI/180,r2d=180/Math.PI;function tileToBBOX(t){var e=tile2lon(t[0]+1,t[2]);return[tile2lon(t[0],t[2]),tile2lat(t[1]+1,t[2]),e,tile2lat(t[1],t[2])]}function tileToGeoJSON(t){var e=tileToBBOX(t);return{type:"Polygon",coordinates:[[[e[0],e[3]],[e[0],e[1]],[e[2],e[1]],[e[2],e[3]],[e[0],e[3]]]]}}function tile2lon(t,e){return t/Math.pow(2,e)*360-180}function tile2lat(t,e){var i=Math.PI-2*Math.PI*t/Math.pow(2,e);return r2d*Math.atan(.5*(Math.exp(i)-Math.exp(-i)))}function pointToTile(t,e,i){var n=pointToTileFraction(t,e,i);return n[0]=Math.floor(n[0]),n[1]=Math.floor(n[1]),n}function getChildren(t){return[[2*t[0],2*t[1],t[2]+1],[2*t[0]+1,2*t[1],t[2]+1],[2*t[0]+1,2*t[1]+1,t[2]+1],[2*t[0],2*t[1]+1,t[2]+1]]}function getParent(t){return[t[0]>>1,t[1]>>1,t[2]-1]}function getSiblings(t){return getChildren(getParent(t))}function hasSiblings(t,e){for(var i=getSiblings(t),n=0;n<i.length;n++)if(!hasTile(e,i[n]))return!1;return!0}function hasTile(t,e){for(var i=0;i<t.length;i++)if(tilesEqual(t[i],e))return!0;return!1}function tilesEqual(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function tileToQuadkey(t){for(var e="",i=t[2];i>0;i--){var n=0,o=1<<i-1;0!=(t[0]&o)&&n++,0!=(t[1]&o)&&(n+=2),e+=n.toString()}return e}function quadkeyToTile(t){for(var e=0,i=0,n=t.length,o=n;o>0;o--){var r=1<<o-1,l=+t[n-o];1===l&&(e|=r),2===l&&(i|=r),3===l&&(e|=r,i|=r)}return[e,i,n]}function bboxToTile(t){var e=pointToTile(t[0],t[1],32),i=pointToTile(t[2],t[3],32),n=[e[0],e[1],i[0],i[1]],o=getBboxZoom(n);return 0===o?[0,0,0]:[n[0]>>>32-o,n[1]>>>32-o,o]}function getBboxZoom(t){for(var e=0;e<28;e++){var i=1<<32-(e+1);if((t[0]&i)!=(t[2]&i)||(t[1]&i)!=(t[3]&i))return e}return 28}function pointToTileFraction(t,e,i){var n=Math.sin(e*d2r),o=Math.pow(2,i),r=o*(t/360+.5);return(r%=o)<0&&(r+=o),[r,o*(.5-.25*Math.log((1+n)/(1-n))/Math.PI),i]}module.exports={tileToGeoJSON:tileToGeoJSON,tileToBBOX:tileToBBOX,getChildren:getChildren,getParent:getParent,getSiblings:getSiblings,hasTile:hasTile,hasSiblings:hasSiblings,tilesEqual:tilesEqual,tileToQuadkey:tileToQuadkey,quadkeyToTile:quadkeyToTile,pointToTile:pointToTile,bboxToTile:bboxToTile,pointToTileFraction:pointToTileFraction};